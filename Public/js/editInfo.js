/* SVN.committedRevision=1229630 */
jQuery(document).ready(function(){if($("#emailBind").length){$("#emailBind").click(function(){if("立即绑定"!=$("#emailBind").text()){return}var k;var i=/^\w[\w\$\^\(\)\[\]\{\}\.\-\+,]{0,100}@([a-zA-Z0-9][\w\-]*\.)+[a-zA-Z]{2,6}$/;if(jQuery("input[name='userInfo.email']").length){var l=jQuery("input[name='userInfo.email']").val();k="/activate/sendEmail.do?userEmail="+l+"&callback=?";if($.trim(l)==null||$.trim(l)==""||$.trim(l)=="绑定邮箱，送20积分，可兑各种抵用券"){jQuery("#err_popwin").html("邮箱为空，请输入您要绑定的邮箱！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});$("#userEmail").focus(function(){jQuery("#userEmail").val("").css("color","#333")});return}else{if(!i.test(l)){jQuery("#err_popwin").html("您输入的邮箱格式不正确，请重新输入！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});$("#userEmail").focus(function(){jQuery("#userEmail").val("").css("color","#333")
});return}}}else{k="/activate/sendEmail.do?callback=?"}$.getJSON(k,function(m){if(m.code==0){jQuery("#err_popwin").html("验证邮件已经发送至您的邮箱，请登录邮箱进行验证！");disableBtnCountDown();yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}else{if(m.code==2){clearDisableBtnCountDown();jQuery("#err_popwin").html("您输入的邮箱格式不正确，请重新输入！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});$("#userEmail").focus(function(){jQuery("#userEmail").val("").css("color","#333")})}else{if(m.code==5){clearDisableBtnCountDown();jQuery("#err_popwin").html("该邮箱已存在，请换个邮箱绑定！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});$("#userEmail").focus(function(){jQuery("#userEmail").val("").css("color","#333")})}else{if(m.code==6){jQuery("#err_popwin").html("发送邮件太频繁了,请1分钟后重试！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})
}else{clearDisableBtnCountDown();jQuery("#err_popwin").html("验证邮件发送失败，请重试！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}}}}})})}jQuery(document).ready(function(){var i=$("#utype").val();if(i==1){$(".checked_real_name").show();$(".person_info").hide()}else{$(".checked_real_name").hide();$(".person_info").show()}});$(".title_checked").click(function(){$(".checked_real_name").show();$(".person_info").hide()});$(".title_info").click(function(){$(".checked_real_name").hide();$(".person_info").show()});$("#idCard").blur(function(){var i=$.trim($(this).val());var l=i.length;if(l<18){$("#tipinfo").html('<i class="icon_wrong"></i><span class="warn_box"><i class="icon_warn"></i><span>请正确输入18位二代身份证号码</span></span>');return false}var k=/(^\d{17}(\d|X)$)/;if(!(k.test(i)&&isValid18(i))){$("#tipinfo").html('<i class="icon_wrong"></i><span class="warn_box"><i class="icon_warn"></i><span>请正确输入您的身份证号码</span></span>');
return false}$("#tipinfo").html('<i class="icon_right"></i>');return true});$(".container_id_card").hover(function(){var i=$(this).find(".small_pic").attr("src");if($.trim(i).length>0){$(this).find(".bigger_id_card").html('<img src="'+i+'"/>');$(this).find(".hover_container").show()}},function(){$(this).find(".hover_container").hide()});$("#mobileBind").click(function(){window.location="/member/safecenter/index.do"});$("#btnSubmit").click(function(){if(jQuery("input[name='userInfo.email']").length){var k=jQuery.trim(jQuery("input[name='userInfo.email']").val());if(k==""||k=="绑定邮箱，送20积分，可兑各种抵用券"){jQuery("input[name='userInfo.email']").val("")}else{var l=/^\w[\w\$\^\(\)\[\]\{\}\.\-\+,]{0,100}@([a-zA-Z0-9][\w\-]*\.)+[a-zA-Z]{2,6}$/;if(!l.test(k)){jQuery("#err_popwin").html("请填写正确的邮箱地址。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});
return false}}if(k!=filterScripts(k)){jQuery("#err_popwin").html("请填写正确邮箱地址。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}var i="/activate/checkEmailIsExist.do?userEmail="+k+"&callback=?";$.getJSON(i,function(m){if(m.code==1){if(!checkOtherNoEmail()){return false}jQuery("#updateBaseInfoSubmit").submit()}else{jQuery("#err_popwin").html("该邮箱已存在，请换个邮箱绑定！");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}})}else{if(!checkOtherNoEmail()){return false}jQuery("#updateBaseInfoSubmit").submit()}return false});if(jQuery("input[name='userInfo.email']").length){$("#userEmail").focus(function(){if($(this).val()=="绑定邮箱，送20积分，可兑各种抵用券"){$(this).val("").css("color","#333")}else{$(this).css("color","#333")}}).blur(function(){if(!$(this).val().replace(/\s/gi,"")){$(this).val("绑定邮箱，送20积分，可兑各种抵用券").css("color","#ccc")
}})}var b=new Date();var h=b.getFullYear();if(jQuery("select[name='birthYear']").attr("alt")!=""){var c=jQuery("select[name='birthYear']").attr("alt");for(var e=0;e<80;e++){if((h-e)==c){jQuery("select[name='birthYear']").append("<option value='"+(h-e)+"' selected>"+(h-e)+"</option>");jQuery("select[name='birthYear']").attr("disabled","disabled")}else{jQuery("select[name='birthYear']").append("<option value='"+(h-e)+"'>"+(h-e)+"</option>")}}}else{jQuery("select[name='birthYear']").prepend("<option value='0' selected='selected'>选择年</option>");for(var e=0;e<80;e++){jQuery("select[name='birthYear']").append("<option value='"+(h-e)+"'>"+(h-e)+"</option>")}}if(jQuery("select[name='birthMonth']").attr("alt")!=""){var a=jQuery("select[name='birthMonth']").attr("alt");for(var e=1;e<=12;e++){if(e==a){jQuery("select[name='birthMonth']").append("<option value='"+e+"' selected>"+e+"</option>");
jQuery("select[name='birthMonth']").attr("disabled","disabled")}else{jQuery("select[name='birthMonth']").append("<option value='"+e+"'>"+e+"</option>")}}}else{jQuery("select[name='birthMonth']").prepend("<option value='0' selected='selected'>选择月</option>");for(var e=1;e<=12;e++){jQuery("select[name='birthMonth']").append("<option value='"+e+"'>"+e+"</option>")}}var j=31;if(jQuery("select[name='birthYear']").attr("alt")!==""&&jQuery("select[name='birthMonth']").attr("alt")!=""){j=f(jQuery("select[name='birthYear']").attr("alt"),jQuery("select[name='birthMonth']").attr("alt"))}if(jQuery("select[name='birthDate']").attr("alt")!=""){var a=jQuery("select[name='birthDate']").attr("alt");for(var e=1;e<=j;e++){if(e==a){jQuery("select[name='birthDate']").append("<option value='"+e+"' selected='selected'>"+e+"</option>");
jQuery("select[name='birthDate']").attr("disabled","disabled")}else{jQuery("select[name='birthDate']").append("<option value='"+e+"'>"+e+"</option>")}}}else{jQuery("select[name='birthDate']").prepend("<option value='0' selected='selected'>选择日</option>");for(var e=1;e<=j;e++){jQuery("select[name='birthDate']").append("<option value='"+e+"'>"+e+"</option>")}}jQuery("select[name='birthYear']").click(function(){if(jQuery("select[name='birthYear']").val()!="0"){jQuery("select[name='birthYear'] option[value='"+jQuery("select[name='birthYear']").val()+"']").attr("select",true)}else{jQuery("select[name='birthYear']").val(h-20)}jQuery("select[name='birthYear'] option[value='0']").remove()});jQuery("select[name='birthYear']").change(function(){});jQuery("select[name='birthMonth']").change(function(){d()
});function d(){var l=jQuery("select[name='birthDate']").val();jQuery("select[name='birthDate']").empty();j=f(jQuery("select[name='birthYear']").val(),jQuery("select[name='birthMonth']").val());if(l>j){l=j}for(var k=1;k<=j;k++){if(k==l){jQuery("select[name='birthDate']").append("<option value='"+k+"' selected>"+k+"</option>")}else{jQuery("select[name='birthDate']").append("<option value='"+k+"'>"+k+"</option>")}}}function f(i,k){if(k==4||k==6||k==9||k==11){return 30}else{if(k==1||k==3||k==5||k==7||k==8||k==10||k==12){return 31}else{if(i%4==0&&i%100!=0){return 29}else{return 28}}}}jQuery("#editp button").click(function(){jQuery.get("/member/userinfo/alterImage.do?userInfo.userPic="+encodeURIComponent(jQuery("#userface").attr("src")),function(){jQuery("#editp").css("display","none")});return false
});var g=new Array(6);g[0]=URLPrefix.statics+"/member/images/peopleicon_01.gif";g[1]=URLPrefix.statics+"/member/images/peopleicon_02.gif";g[2]=URLPrefix.statics+"/member/images/peopleicon_03.gif";g[3]=URLPrefix.statics+"/member/images/peopleicon_04.gif";g[4]=URLPrefix.statics+"/member/images/peopleicon_05.gif";g[5]=URLPrefix.statics+"/member/images/peopleicon_06.gif";jQuery("#editp a img").each(function(i){jQuery(this).attr("src",g[i]);jQuery(this).click(function(){jQuery("#userface").attr("src",jQuery(this).attr("src"));jQuery(":hidden[name='userInfo.userPic']").val(jQuery(this).attr("src"))})})});var intervalKey=undefined;var disableBtnCountDown=function(){if(intervalKey){clearInterval(intervalKey)}var a=jQuery("#emailBind");var b=60;intervalKey=setInterval(function(){a.text(b+"秒重发");b--;
if(b<=0){a.text("立即绑定");clearDisableBtnCountDown()}},1000)};var clearDisableBtnCountDown=function(){if(intervalKey){clearInterval(intervalKey)}};var MY_YHD=new function(){this.alert=function(a){if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/6./i)=="6."){jQuery("select").css("display","none");YHD.alert(a,function(){jQuery("select").css("display","")})}else{YHD.alert(a)}}};function filterScripts(a){var b="";b=decodeURIComponent(a);b=b.replace(/<script(.|\n)*\/script>\s*/ig,"").replace(/<javascript(.|\n)*\/javascript>\s*/ig,"").replace(/<[^>]+/ig,function(c){return c.replace(/\s*on\w+=[^ ]+/ig,"")});return b}function checkOtherNoEmail(){var b=jQuery(":text[name='userInfo.nick']").val();if(b!=""){if(b.length>40){jQuery("#err_popwin").html("请填写昵称，不超过40个字。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});
return false}if(b!=filterScripts(b)){jQuery("#err_popwin").html("您填写的内容包含非法信息。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}}var a=jQuery("#end_user_real_realname_1").val();if(a==""){jQuery("#err_popwin").html("请输入您的真实姓名");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}if(a!=""){if(a.length>40){jQuery("#err_popwin").html("请填写姓名，不超过40个字。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}if(a!=filterScripts(a)){jQuery("#err_popwin").html("您填写的内容包含非法信息。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}}var d=jQuery("select[name='birthYear']").find("option").attr("value");var c=jQuery("select[name='birthDate']").find("option").attr("value");if(d==0||c==0){jQuery("#err_popwin").html("请选择生日的年、月、日");
yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}return true}$(function(){var enduserId=$("#userId").val();var ut=jQuery.cookie("ut");$("#card_front").uploadify({swf:"/required/uploadify.swf",uploader:"/member/userAuth/frontCardUpload.do?endUserId="+enduserId+"&ut="+ut,multi:false,buttonText:"点击上传",buttonClass:"btn_click_submit",height:"26px",width:"80px",fileSizeLimit:"8192k",fileTypeExts:"*.jpg;*.jpeg;*.png",fileObjName:"frontCard",queueID:"frond_card_queue",removeTimeout:"1",onFallback:function(){var fls=flashChecker();if(fls.f){if(fls.v<9){var msg="<span style='color:red;'>&nbsp;&nbsp;您需要安装并启用最新的Adobe flash，才可以上传图片</span>  <a style='color:blue;' target='_blank' href='http://www.adobe.com/go/getflashplayer'>更新</a>";jQuery("#flashPlayInstallEditinfoCheck").html(msg)
}}else{var msg="<span style='color:red;'>&nbsp;&nbsp;您需要安装并启用最新的Adobe flash，才可以上传图片</span>  <a style='color:blue;' target='_blank' href='http://www.adobe.com/go/getflashplayer'>下载</a>";jQuery("#flashPlayInstallEditinfoCheck").html(msg)}},onSelectError:function(file,errorCode,errorMsg){switch(errorCode){case -110:jQuery("#err_popwin").html("您上传的图片大于8MB，请处理至8MB以下再次上传");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});break;case -120:break;case -130:jQuery("#err_popwin").html("请选择jpg、png格式的图片文件进行上传");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});break}},onUploadSuccess:function(file,data,response){var obj=eval("("+data+")");var result=obj.result;if(result==1){$("#front_card_image").attr("src",obj.fronturl);jQuery("#err_popwin").html("身份证正面图片上传成功");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})
}else{jQuery("#err_popwin").html("身份证正面图片上传失败");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}}});$("#card_back").uploadify({swf:"/required/uploadify.swf",uploader:"/member/userAuth/backCardUpload.do?endUserId="+enduserId+"&ut="+ut,multi:false,buttonText:"点击上传",buttonClass:"btn_click_submit",height:"26px",width:"80px",fileSizeLimit:"8192k",fileTypeExts:"*.jpg;*.jpeg;*.png",fileObjName:"backCard",queueID:"back_card_queue",removeTimeout:"1",onFallback:function(){var fls=flashChecker();if(fls.f){if(fls.v<9){var msg="<span style='color:red;'>&nbsp;&nbsp;您需要安装并启用最新的Adobe flash，才可以上传图片</span>  <a style='color:blue;' target='_blank' href='http://www.adobe.com/go/getflashplayer'>更新</a>";jQuery("#flashPlayInstallEditinfoCheck").html(msg)}}else{var msg="<span style='color:red;'>&nbsp;&nbsp;您需要安装并启用最新的Adobe flash，才可以上传图片</span>  <a style='color:blue;' target='_blank' href='http://www.adobe.com/go/getflashplayer'>下载</a>";
jQuery("#flashPlayInstallEditinfoCheck").html(msg)}},onSelectError:function(file,errorCode,errorMsg){switch(errorCode){case -110:jQuery("#err_popwin").html("您上传的图片大于8MB，请处理至8MB以下再次上传");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});break;case -120:break;case -130:jQuery("#err_popwin").html("请选择jpg、png格式的图片文件进行上传");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});break}},onUploadSuccess:function(file,data,response){var obj=eval("("+data+")");var result=obj.result;if(result==1){$("#back_card_image").attr("src",obj.backurl);jQuery("#err_popwin").html("身份证背面图片上传成功");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}else{jQuery("#err_popwin").html("身份证背面图片上传失败");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}}});$("#saveIdCardBtn").click(function(){var userRealRealName=jQuery("#end_user_real_realname_2").val();
if(userRealRealName==""){jQuery("#err_popwin").html("请输入您的真实姓名");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}if(userRealRealName!=""){if(userRealRealName.length>40){jQuery("#err_popwin").html("请填写姓名，不超过40个字。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}if(userRealRealName!=filterScripts(userRealRealName)){jQuery("#err_popwin").html("您填写的内容包含非法信息。");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}}var idCardValue=$("#idCard").val();var idCardLength=$.trim(idCardValue).length;if(idCardLength<18){$("#tipinfo").html('<i class="icon_wrong"></i><span class="warn_box"><i class="icon_warn"></i><span>请正确输入18位二代身份证号码</span></span>');return false}var reg=/(^\d{17}(\d|X)$)/;if(!(reg.test(idCardValue)&&isValid18(idCardValue))){$("#tipinfo").html('<i class="icon_wrong"></i><span class="warn_box"><i class="icon_warn"></i><span>请正确输入您的身份证号码</span></span>');
return false}var fronturl=$("#front_card_image").attr("src");if($.trim(fronturl).length==0){jQuery("#err_popwin").html("请上传身份证正面图片");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}var backurl=$("#back_card_image").attr("src");if($.trim(backurl).length==0){jQuery("#err_popwin").html("请上传身份证背面图片");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"});return false}$.ajax({type:"post",url:"/member/userAuth/updateUserAuth.do",data:{endUserId:enduserId,ut:ut,"userInfo.endUserRealRealName":$("#end_user_real_realname_2").val(),"userInfo.idCard":$("#idCard").val(),"userInfo.fronturl":$("#front_card_image").attr("src"),"userInfo.backurl":$("#back_card_image").attr("src")},cache:false,success:function(data){var result=data.result;if(result==1){jQuery("#err_popwin").html("实名认证信息保存成功");
$("#end_user_real_realname_1").val($("#end_user_real_realname_2").val());yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}else{jQuery("#err_popwin").html("实名认证信息保存失败");yhdLib.popwin({poptitle:"温馨提示",popcontent:".error_info_show"})}}});return true})});function isValid18(e){var h=new Array("7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2");var g=new Array("1","0","X","9","8","7","6","5","4","3","2");var e=e+"";var d=e.substr(0,17);var f=e.substr(17);var a=0;for(var c=0;c<17;c++){a+=parseInt(d.charAt(c))*parseInt(h[c])}var b=parseInt(a)%11;if(g[b]==f){return true}return false};(function(j){var g=Math.abs,h=Math.max,k=Math.min,l=Math.round;function i(){return j("<div/>")}j.imgAreaSelect=function(br,e){var b=j(br),a,ax=i(),a1=i(),aV=i().add(i()).add(i()).add(i()),be=i().add(i()).add(i()).add(i()),aN=j([]),aw,bv,bt,bi={left:0,top:0},aJ,bz,bb,aL={left:0,top:0},a9=0,a5="absolute",aE,aG,ba,bd,aT,a7,ay,o,aS,c,aP,bf,bh,bl,bj,bm={x1:0,y1:0,x2:0,y2:0,width:0,height:0},bu=document.documentElement,bx,az,aM,aZ,a6,aK,bn;function aX(m){return m+bi.left-aL.left}function aY(m){return m+bi.top-aL.top}function a0(m){return m-bi.left+aL.left}function bc(m){return m-bi.top+aL.top}function aO(m){return m.pageX-aL.left}function aU(m){return m.pageY-aL.top}function a3(n){var p=n||ba,m=n||bd;return{x1:l(bm.x1*p),y1:l(bm.y1*m),x2:l(bm.x2*p),y2:l(bm.y2*m),width:l(bm.x2*p)-l(bm.x1*p),height:l(bm.y2*m)-l(bm.y1*m)}
}function a2(r,n,s,t,q){var m=q||ba,p=q||bd;bm={x1:l(r/m||0),y1:l(n/p||0),x2:l(s/m||0),y2:l(t/p||0)};bm.width=bm.x2-bm.x1;bm.height=bm.y2-bm.y1}function aI(){if(!b.width()){return}bi={left:l(b.offset().left),top:l(b.offset().top)};aJ=b.innerWidth();bz=b.innerHeight();bi.top+=(b.outerHeight()-bz)>>1;bi.left+=(b.outerWidth()-aJ)>>1;a7=l(e.minWidth/ba)||0;ay=l(e.minHeight/bd)||0;o=l(k(e.maxWidth/ba||1<<24,aJ));aS=l(k(e.maxHeight/bd||1<<24,bz));if(j().jquery=="1.3.2"&&a5=="fixed"&&!bu.getBoundingClientRect){bi.top+=h(document.body.scrollTop,bu.scrollTop);bi.left+=h(document.body.scrollLeft,bu.scrollLeft)}aL=/absolute|relative/.test(bb.css("position"))?{left:l(bb.offset().left)-bb.scrollLeft(),top:l(bb.offset().top)-bb.scrollTop()}:a5=="fixed"?{left:j(document).scrollLeft(),top:j(document).scrollTop()}:{left:0,top:0};
bv=aX(0);bt=aY(0);if(bm.x2>aJ||bm.y2>bz){d()}}function bg(m){if(!aP){return}ax.css({left:aX(bm.x1),top:aY(bm.y1)}).add(a1).width(a6=bm.width).height(aK=bm.height);a1.add(aV).add(aN).css({left:0,top:0});aV.width(h(a6-aV.outerWidth()+aV.innerWidth(),0)).height(h(aK-aV.outerHeight()+aV.innerHeight(),0));j(be[0]).css({left:bv,top:bt,width:bm.x1,height:bz});j(be[1]).css({left:bv+bm.x1,top:bt,width:a6,height:bm.y1});j(be[2]).css({left:bv+bm.x2,top:bt,width:aJ-bm.x2,height:bz});j(be[3]).css({left:bv+bm.x1,top:bt+bm.y2,width:a6,height:bz-bm.y2});a6-=aN.outerWidth();aK-=aN.outerHeight();switch(aN.length){case 8:j(aN[4]).css({left:a6>>1});j(aN[5]).css({left:a6,top:aK>>1});j(aN[6]).css({left:a6>>1,top:aK});j(aN[7]).css({top:aK>>1});case 4:aN.slice(1,3).css({left:a6});aN.slice(2,4).css({top:aK})}if(m!==false){if(j.imgAreaSelect.keyPress!=w){j(document).unbind(j.imgAreaSelect.keyPress,j.imgAreaSelect.onKeyPress)
}if(e.keys){j(document)[j.imgAreaSelect.keyPress](j.imgAreaSelect.onKeyPress=w)}}if(j.browser.msie&&aV.outerWidth()-aV.innerWidth()==2){aV.css("margin",0);setTimeout(function(){aV.css("margin","auto")},0)}}function bp(m){aI();bg(m);bf=aX(bm.x1);bh=aY(bm.y1);bl=aX(bm.x2);bj=aY(bm.y2)}function aW(n,m){e.fadeSpeed?n.fadeOut(e.fadeSpeed,m):n.hide()}function a4(m){var n=a0(aO(m))-bm.x1,p=bc(aU(m))-bm.y1;if(!bn){aI();bn=true;ax.one("mouseout",function(){bn=false})}aT="";if(e.resizable){if(p<=e.resizeMargin){aT="n"}else{if(p>=bm.height-e.resizeMargin){aT="s"}}if(n<=e.resizeMargin){aT+="w"}else{if(n>=bm.width-e.resizeMargin){aT+="e"}}}ax.css("cursor",aT?aT+"-resize":e.movable?"move":"");if(aw){aw.toggle()}}function aR(m){j("body").css("cursor","");if(e.autoHide||bm.width*bm.height==0){aW(ax.add(be),function(){j(this).hide()
})}j(document).unbind("mousemove",a8);ax.mousemove(a4);e.onSelectEnd(br,a3())}function bq(m){if(m.which!=1){return false}aI();if(aT){j("body").css("cursor",aT+"-resize");bf=aX(bm[/w/.test(aT)?"x2":"x1"]);bh=aY(bm[/n/.test(aT)?"y2":"y1"]);j(document).mousemove(a8).one("mouseup",aR);ax.unbind("mousemove",a4)}else{if(e.movable){aE=bv+bm.x1-aO(m);aG=bt+bm.y1-aU(m);ax.unbind("mousemove",a4);j(document).mousemove(bA).one("mouseup",function(){e.onSelectEnd(br,a3());j(document).unbind("mousemove",bA);ax.mousemove(a4)})}else{b.mousedown(m)}}return false}function bs(m){if(c){if(m){bl=h(bv,k(bv+aJ,bf+g(bj-bh)*c*(bl>bf||-1)));bj=l(h(bt,k(bt+bz,bh+g(bl-bf)/c*(bj>bh||-1))));bl=l(bl)}else{bj=h(bt,k(bt+bz,bh+g(bl-bf)/c*(bj>bh||-1)));bl=l(h(bv,k(bv+aJ,bf+g(bj-bh)*c*(bl>bf||-1))));bj=l(bj)}}}function d(){bf=k(bf,bv+aJ);
bh=k(bh,bt+bz);if(g(bl-bf)<a7){bl=bf-a7*(bl<bf||-1);if(bl<bv){bf=bv+a7}else{if(bl>bv+aJ){bf=bv+aJ-a7}}}if(g(bj-bh)<ay){bj=bh-ay*(bj<bh||-1);if(bj<bt){bh=bt+ay}else{if(bj>bt+bz){bh=bt+bz-ay}}}bl=h(bv,k(bl,bv+aJ));bj=h(bt,k(bj,bt+bz));bs(g(bl-bf)<g(bj-bh)*c);if(g(bl-bf)>o){bl=bf-o*(bl<bf||-1);bs()}if(g(bj-bh)>aS){bj=bh-aS*(bj<bh||-1);bs(true)}bm={x1:a0(k(bf,bl)),x2:a0(h(bf,bl)),y1:bc(k(bh,bj)),y2:bc(h(bh,bj)),width:g(bl-bf),height:g(bj-bh)};bg();e.onSelectChange(br,a3())}function a8(m){bl=/w|e|^$/.test(aT)||c?aO(m):aX(bm.x2);bj=/n|s|^$/.test(aT)||c?aU(m):aY(bm.y2);d();return false}function aH(n,m){bl=(bf=n)+bm.width;bj=(bh=m)+bm.height;j.extend(bm,{x1:a0(bf),y1:bc(bh),x2:a0(bl),y2:bc(bj)});bg();e.onSelectChange(br,a3())}function bA(m){bf=h(bv,k(aE+aO(m),bv+aJ-bm.width));bh=h(bt,k(aG+aU(m),bt+bz-bm.height));
aH(bf,bh);m.preventDefault();return false}function bk(){j(document).unbind("mousemove",bk);aI();bl=bf;bj=bh;d();aT="";if(!be.is(":visible")){ax.add(be).hide().fadeIn(e.fadeSpeed||0)}aP=true;j(document).unbind("mouseup",aF).mousemove(a8).one("mouseup",aR);ax.unbind("mousemove",a4);e.onSelectStart(br,a3())}function aF(){j(document).unbind("mousemove",bk).unbind("mouseup",aF);aW(ax.add(be));a2(a0(bf),bc(bh),a0(bf),bc(bh));if(!this instanceof j.imgAreaSelect){e.onSelectChange(br,a3());e.onSelectEnd(br,a3())}}function bw(m){if(m.which!=1||be.is(":animated")){return false}aI();aE=bf=aO(m);aG=bh=aU(m);j(document).mousemove(bk).mouseup(aF);return false}function bo(){bp(false)}function f(){a=true;aQ(e=j.extend({classPrefix:"imgareaselect",movable:true,parent:"body",resizable:true,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},e));
ax.add(be).css({visibility:""});if(e.show){aP=true;aI();bg();ax.add(be).hide().fadeIn(e.fadeSpeed||0)}setTimeout(function(){e.onInit(br,a3())},0)}var w=function(m){var q=e.keys,n,r,p=m.keyCode;n=!isNaN(q.alt)&&(m.altKey||m.originalEvent.altKey)?q.alt:!isNaN(q.ctrl)&&m.ctrlKey?q.ctrl:!isNaN(q.shift)&&m.shiftKey?q.shift:!isNaN(q.arrows)?q.arrows:10;if(q.arrows=="resize"||(q.shift=="resize"&&m.shiftKey)||(q.ctrl=="resize"&&m.ctrlKey)||(q.alt=="resize"&&(m.altKey||m.originalEvent.altKey))){switch(p){case 37:n=-n;case 39:r=h(bf,bl);bf=k(bf,bl);bl=h(r+n,bf);bs();break;case 38:n=-n;case 40:r=h(bh,bj);bh=k(bh,bj);bj=h(r+n,bh);bs(true);break;default:return}d()}else{bf=k(bf,bl);bh=k(bh,bj);switch(p){case 37:aH(h(bf-n,bv),bh);break;case 38:aH(bf,h(bh-n,bt));break;case 39:aH(bf+k(n,aJ-a0(bl)),bh);break;
case 40:aH(bf,bh+k(n,bz-bc(bj)));break;default:return}}return false};function by(n,m){for(option in m){if(e[option]!==undefined){n.css(m[option],e[option])}}}function aQ(m){if(m.parent){(bb=j(m.parent)).append(ax.add(be))}j.extend(e,m);aI();if(m.handles!=null){aN.remove();aN=j([]);aM=m.handles?m.handles=="corners"?4:8:0;while(aM--){aN=aN.add(i())}aN.addClass(e.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:a9+1||1});if(!parseInt(aN.css("width"))>=0){aN.width(5).height(5)}if(aZ=e.borderWidth){aN.css({borderWidth:aZ,borderStyle:"solid"})}by(aN,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}ba=e.imageWidth/aJ||1;bd=e.imageHeight/bz||1;if(m.x1!=null){a2(m.x1,m.y1,m.x2,m.y2);m.show=!m.hide}if(m.keys){e.keys=j.extend({shift:1,ctrl:"resize"},m.keys)
}ax.addClass(e.classPrefix+"-imgdiv");be.addClass(e.classPrefix+"-outer");a1.addClass(e.classPrefix+"-selection");for(aM=0;aM++<4;){j(aV[aM-1]).addClass(e.classPrefix+"-border"+aM)}by(a1,{selectionColor:"background-color",selectionOpacity:"opacity"});by(aV,{borderOpacity:"opacity",borderWidth:"border-width"});by(be,{outerColor:"background-color",outerOpacity:"opacity"});if(aZ=e.borderColor1){j(aV[0]).css({borderStyle:"solid",borderColor:aZ})}if(aZ=e.borderColor2){j(aV[1]).css({borderStyle:"dashed",borderColor:aZ})}ax.append(a1.add(aV).add(aw).add(aN));if(j.browser.msie){if(aZ=be.css("filter").match(/opacity=(\d+)/)){be.css("opacity",aZ[1]/100)}if(aZ=aV.css("filter").match(/opacity=(\d+)/)){aV.css("opacity",aZ[1]/100)}}if(m.hide){aW(ax.add(be))}else{if(m.show&&a){aP=true;ax.add(be).fadeIn(e.fadeSpeed||0);
bp()}}c=(az=(e.aspectRatio||"").split(/:/))[0]/az[1];b.add(be).unbind("mousedown",bw);if(e.disable||e.enable===false){ax.unbind("mousemove",a4).unbind("mousedown",bq);j(window).unbind("resize",bo)}else{if(e.enable||e.disable===false){if(e.resizable||e.movable){ax.mousemove(a4).mousedown(bq)}j(window).resize(bo)}if(!e.persistent){b.add(be).mousedown(bw)}}e.enable=e.disable=undefined}this.remove=function(){aQ({disable:true});ax.add(be).remove()};this.getOptions=function(){return e};this.setOptions=aQ;this.getSelection=a3;this.setSelection=a2;this.cancelSelection=aF;this.update=bp;bx=b;while(bx.length){a9=h(a9,!isNaN(bx.css("z-index"))?bx.css("z-index"):a9);if(bx.css("position")=="fixed"){a5="fixed"}bx=bx.parent(":not(body)")}a9=e.zIndex||a9;if(j.browser.msie){b.attr("unselectable","on")}j.imgAreaSelect.keyPress=j.browser.msie||j.browser.safari?"keydown":"keypress";
if(j.browser.opera){aw=i().css({width:"100%",height:"100%",position:"absolute",zIndex:a9+2||2})}ax.add(be).css({visibility:"hidden",position:a5,overflow:"hidden",zIndex:a9||"0"});ax.css({zIndex:a9+2||2});a1.add(aV).css({position:"absolute",fontSize:0});br.complete||br.readyState=="complete"||!b.is("img")?f():b.one("load",f);if(j.browser.msie&&j.browser.version>=7){br.src=br.src}};j.fn.imgAreaSelect=function(a){a=a||{};this.each(function(){if(j(this).data("imgAreaSelect")){if(a.remove){j(this).data("imgAreaSelect").remove();j(this).removeData("imgAreaSelect")}else{j(this).data("imgAreaSelect").setOptions(a)}}else{if(!a.remove){if(a.enable===undefined&&a.disable===undefined){a.enable=true}j(this).data("imgAreaSelect",new j.imgAreaSelect(this,a))}}});if(a.instance){return j(this).data("imgAreaSelect")
}return this}})(jQuery);function FileProgress(l,h){this.fileProgressID=l.id;this.opacity=100;this.height=0;this.fileProgressWrapper=document.getElementById(this.fileProgressID);if(!this.fileProgressWrapper){this.fileProgressWrapper=document.createElement("div");this.fileProgressWrapper.className="progressWrapper";this.fileProgressWrapper.id=this.fileProgressID;this.fileProgressElement=document.createElement("div");this.fileProgressElement.className="progressContainer";var i=document.createElement("a");i.className="progressCancel";i.href="#";i.style.visibility="hidden";i.appendChild(document.createTextNode(" "));var g=document.createElement("div");g.className="progressName";g.appendChild(document.createTextNode(l.name));var j=document.createElement("div");j.className="progressBarInProgress";var k=document.createElement("div");
k.className="progressBarStatus";k.innerHTML="&nbsp;";this.fileProgressElement.appendChild(i);this.fileProgressElement.appendChild(g);this.fileProgressElement.appendChild(k);this.fileProgressElement.appendChild(j);this.fileProgressWrapper.appendChild(this.fileProgressElement);document.getElementById(h).appendChild(this.fileProgressWrapper)}else{this.fileProgressElement=this.fileProgressWrapper.firstChild;this.reset()}this.height=this.fileProgressWrapper.offsetHeight;this.setTimer(null)}FileProgress.prototype.setTimer=function(b){this.fileProgressElement.FP_TIMER=b};FileProgress.prototype.getTimer=function(b){return this.fileProgressElement.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[2].innerHTML="&nbsp;";
this.fileProgressElement.childNodes[2].className="progressBarStatus";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width="0%";this.appear()};FileProgress.prototype.setProgress=function(b){this.fileProgressElement.className="progressContainer green";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width=b+"%";this.appear()};FileProgress.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer blue";this.fileProgressElement.childNodes[3].className="progressBarComplete";this.fileProgressElement.childNodes[3].style.width="";var b=this;this.setTimer(setTimeout(function(){b.disappear()},10000))};FileProgress.prototype.setError=function(){this.fileProgressElement.className="progressContainer red";
this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var b=this;this.setTimer(setTimeout(function(){b.disappear()},5000))};FileProgress.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var b=this;this.setTimer(setTimeout(function(){b.disappear()},2000))};FileProgress.prototype.setStatus=function(b){this.fileProgressElement.childNodes[2].innerHTML=b};FileProgress.prototype.toggleCancel=function(d,f){this.fileProgressElement.childNodes[0].style.visibility=d?"visible":"hidden";if(f){var e=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){f.cancelUpload(e);
return false}}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(b){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)"}}else{this.fileProgressWrapper.style.opacity=1}this.fileProgressWrapper.style.height="";this.height=this.fileProgressWrapper.offsetHeight;this.opacity=100;this.fileProgressWrapper.style.display=""};FileProgress.prototype.disappear=function(){var h=15;var j=4;var e=30;if(this.opacity>0){this.opacity-=h;if(this.opacity<0){this.opacity=0}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=this.opacity
}catch(i){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+this.opacity+")"}}else{this.fileProgressWrapper.style.opacity=this.opacity/100}}if(this.height>0){this.height-=j;if(this.height<0){this.height=0}this.fileProgressWrapper.style.height=this.height+"px"}if(this.height>0||this.opacity>0){var g=this;this.setTimer(setTimeout(function(){g.disappear()},e))}else{this.fileProgressWrapper.style.display="none";this.setTimer(null)}};function cancelQueue(d){document.getElementById(d.customSettings.cancelButtonId).disabled=true;d.stopUpload();var c;do{c=d.getStats();d.cancelUpload()}while(c.files_queued!==0)}function preLoad(){if(!this.support.loading){alert("You need the Flash Player 9.028 or above to use SWFUpload.");return false}}function loadFailed(){alert("Something went wrong while loading SWFUpload. If this were a real application we'd clean up and then give you an alternative")}function fileDialogStart(){}function mouseClick(){DialogLogin.execute(function(){upload2.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES)})}function fileQueued(f){try{var e=new FileProgress(f,this.customSettings.progressTarget);e.setStatus("Pending...");e.toggleCancel(true,this)}catch(d){this.debug(d)}}function fileQueueError(j,h,i){try{if(h==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT){alert(j.name+"文件过大,最多不能超过5MB！");
return}if(h==SWFUpload.QUEUE_ERROR.INVALID_FILETYPE){alert("只能上传jpg,png,jpeg格式的文件");return}var g=new FileProgress(j,this.customSettings.progressTarget);g.setError();g.toggleCancel(false);switch(h){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:g.setStatus("File is too big.");this.debug("Error Code: File too big, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:g.setStatus("Cannot upload Zero Byte files.");this.debug("Error Code: Zero byte file, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:g.setStatus("Invalid File Type.");this.debug("Error Code: Invalid File Type, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:alert("You have selected too many files.  "+(i>1?"You may only add "+i+" more files":"You cannot add any more files."));
break;default:if(j!==null){g.setStatus("Unhandled Error")}this.debug("Error Code: "+h+", File name: "+j.name+", File size: "+j.size+", Message: "+i);break}}catch(f){this.debug(f)}}function fileDialogComplete(e,f){try{if(this.getStats().files_queued>0){document.getElementById(this.customSettings.cancelButtonId).disabled=false}jQuery("#image_count_to_upload").text(this.getStats().files_queued+"张图片准备上传");jQuery(".image_preview").fadeIn();jQuery(".success_uploading").attr({disabled:false});this.startUpload()}catch(d){this.debug(d)}}function uploadStart(f){try{var e=new FileProgress(f,this.customSettings.progressTarget);e.setStatus("Uploading...");e.toggleCancel(true,this)}catch(d){}return true}function uploadProgress(l,i,j){try{var k=Math.ceil((i/j)*100);var h=new FileProgress(l,this.customSettings.progressTarget);
h.setProgress(k);h.setStatus("Uploading...")}catch(g){this.debug(g)}}function uploadSuccess(g,e){try{var f=new FileProgress(g,this.customSettings.progressTarget);f.setComplete();f.setStatus("Complete.");f.toggleCancel(false)}catch(h){this.debug(h)}}function uploadComplete(c){try{if(this.getStats().files_queued===0){document.getElementById(this.customSettings.cancelButtonId).disabled=true}else{this.startUpload()}}catch(d){this.debug(d)}}function uploadError(j,h,i){try{var g=new FileProgress(j,this.customSettings.progressTarget);g.setError();g.toggleCancel(false);switch(h){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:g.setStatus("Upload Error: "+i);this.debug("Error Code: HTTP Error, File name: "+j.name+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:g.setStatus("Configuration Error");
this.debug("Error Code: No backend file, File name: "+j.name+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:g.setStatus("Upload Failed.");this.debug("Error Code: Upload Failed, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:g.setStatus("Server (IO) Error");this.debug("Error Code: IO Error, File name: "+j.name+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:g.setStatus("Security Error");this.debug("Error Code: Security Error, File name: "+j.name+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:g.setStatus("Upload limit exceeded.");this.debug("Error Code: Upload Limit Exceeded, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:g.setStatus("File not found.");
this.debug("Error Code: The file was not found, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:g.setStatus("Failed Validation.  Upload skipped.");this.debug("Error Code: File Validation Failed, File name: "+j.name+", File size: "+j.size+", Message: "+i);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:if(this.getStats().files_queued===0){document.getElementById(this.customSettings.cancelButtonId).disabled=true}g.setStatus("Cancelled");g.setCancelled();break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:g.setStatus("Stopped");break;default:g.setStatus("Unhandled Error: "+error_code);this.debug("Error Code: "+h+", File name: "+j.name+", File size: "+j.size+", Message: "+i);break}}catch(f){this.debug(f)}};var SWFUpload;if(typeof(SWFUpload)==="function"){SWFUpload.queue={};SWFUpload.prototype.initSettings=(function(a){return function(b){if(typeof(a)==="function"){a.call(this,b)}this.queueSettings={};this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0;this.queueSettings.user_upload_complete_handler=this.settings.upload_complete_handler;this.queueSettings.user_upload_start_handler=this.settings.upload_start_handler;this.settings.upload_complete_handler=SWFUpload.queue.uploadCompleteHandler;this.settings.upload_start_handler=SWFUpload.queue.uploadStartHandler;this.settings.queue_complete_handler=b.queue_complete_handler||null}})(SWFUpload.prototype.initSettings);SWFUpload.prototype.startUpload=function(a){this.queueSettings.queue_cancelled_flag=false;this.callFlash("StartUpload",[a])
};SWFUpload.prototype.cancelQueue=function(){this.queueSettings.queue_cancelled_flag=true;this.stopUpload();var a=this.getStats();while(a.files_queued>0){this.cancelUpload();a=this.getStats()}};SWFUpload.queue.uploadStartHandler=function(a){var b;if(typeof(this.queueSettings.user_upload_start_handler)==="function"){b=this.queueSettings.user_upload_start_handler.call(this,a)}b=(b===false)?false:true;this.queueSettings.queue_cancelled_flag=!b;return b};SWFUpload.queue.uploadCompleteHandler=function(d){var a=this.queueSettings.user_upload_complete_handler;var b;if(d.filestatus===SWFUpload.FILE_STATUS.COMPLETE){this.queueSettings.queue_upload_count++}if(typeof(a)==="function"){b=(a.call(this,d)===false)?false:true}else{if(d.filestatus===SWFUpload.FILE_STATUS.QUEUED){b=false}else{b=true}}if(b){var c=this.getStats();
if(c.files_queued>0&&this.queueSettings.queue_cancelled_flag===false){this.startUpload()}else{if(this.queueSettings.queue_cancelled_flag===false){this.queueEvent("queue_complete_handler",[this.queueSettings.queue_upload_count]);this.queueSettings.queue_upload_count=0}else{this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0}}}}};var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(a){this.initSWFUpload(a)}}SWFUpload.prototype.initSWFUpload=function(b){try{this.customSettings={};this.settings=b;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(a){delete SWFUpload.instances[this.movieName];throw a}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};
SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(a){return a};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(b,a){this.settings[b]=(this.settings[b]==undefined)?a:this.settings[b]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);
this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");
this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);
this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var a,b;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;
if(a==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}b=document.createElement("div");b.innerHTML=this.getFlashHTML();a.parentNode.replaceChild(b.firstChild,a);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")
};SWFUpload.prototype.getFlashVars=function(){var b=this.buildParamString();var a=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(b),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")
};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var b=this.settings.post_params;var a=[];if(typeof(b)==="object"){for(var c in b){if(b.hasOwnProperty(c)){a.push(encodeURIComponent(c.toString())+"="+encodeURIComponent(b[c].toString()))}}}return a.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var b=null;b=this.getMovieElement();if(b&&typeof(b.CallFunction)==="unknown"){for(var d in b){try{if(typeof(b[d])==="function"){b[d]=null}}catch(a){}}try{b.parentNode.removeChild(b)}catch(c){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;
delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(e){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))
};SWFUpload.prototype.addSetting=function(a,b,c){if(b==undefined){return(this.settings[a]=c)}else{return(this.settings[a]=b)}};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined){return this.settings[a]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")
};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelUpload=function(a,b){if(b!==false){b=true}this.callFlash("CancelUpload",[a,b])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.addFileParam=function(c,a,b){return this.callFlash("AddFileParam",[c,a,b])};SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])
};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(a,b){this.settings.file_types=a;this.settings.file_types_description=b;this.callFlash("SetFileTypes",[a,b])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;
this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string"){a=a.replace(" ","").split(",")}this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])
};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined){a=""}this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(b,c){this.settings.button_width=b;this.settings.button_height=c;var a=this.getMovieElement();if(a!=undefined){a.style.width=b+"px";a.style.height=c+"px"}this.callFlash("SetButtonDimensions",[b,c])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(b,a){this.settings.button_text_top_padding=a;this.settings.button_text_left_padding=b;this.callFlash("SetButtonTextPadding",[b,a])
};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(a,b){if(b==undefined){b=[]}else{if(!(b instanceof Array)){b=[b]}}var c=this;if(typeof this.settings[a]==="function"){this.eventQueue.push(function(){this.settings[a].apply(this,b)});setTimeout(function(){c.executeNextEvent()},0)}else{if(this.settings[a]!==null){throw"Event handler "+a+" is unknown or is not a function"
}}};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;if(typeof(a)==="function"){a.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(e){var a=/[$]([0-9a-f]{4})/i;var b={};var f;if(e!=undefined){for(var c in e.post){if(e.post.hasOwnProperty(c)){f=c;var d;while((d=a.exec(f))!==null){f=f.replace(d[0],String.fromCharCode(parseInt("0x"+d[1],16)))}b[f]=e.post[c]}}e.post=b}return e};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(a){return false}};SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();if(!a){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(a);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&typeof(a.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");
for(var c in a){try{if(typeof(a[c])==="function"){a[c]=null}}catch(b){}}}}catch(d){}window.__flash__removeCallback=function(f,g){try{if(f){f[g]=null}}catch(e){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(c,b,a){c=this.unescapeFilePostParams(c);this.queueEvent("file_queue_error_handler",[c,b,a])};SWFUpload.prototype.fileDialogComplete=function(a,b,c){this.queueEvent("file_dialog_complete_handler",[a,b,c])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(a){var b;
if(typeof this.settings.upload_start_handler==="function"){a=this.unescapeFilePostParams(a);b=this.settings.upload_start_handler.call(this,a)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(b===undefined){b=true}b=!!b;this.callFlash("ReturnUploadStart",[b])};SWFUpload.prototype.uploadProgress=function(c,b,a){c=this.unescapeFilePostParams(c);this.queueEvent("upload_progress_handler",[c,b,a])};SWFUpload.prototype.uploadError=function(c,b,a){c=this.unescapeFilePostParams(c);this.queueEvent("upload_error_handler",[c,b,a])};SWFUpload.prototype.uploadSuccess=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_success_handler",[a,c,b])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)
};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(c){if(this.settings.debug){var a,d=[];if(typeof c==="object"&&typeof c.name==="string"&&typeof c.message==="string"){for(var b in c){if(c.hasOwnProperty(b)){d.push(b+": "+c[b])}}a=d.join("\n")||"";d=a.split("\n");a="EXCEPTION: "+d.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(a)}else{SWFUpload.Console.writeLine(c)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(d){var b,a;try{b=document.getElementById("SWFUpload_Console");if(!b){a=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(a);b=document.createElement("textarea");b.id="SWFUpload_Console";b.style.fontFamily="monospace";b.setAttribute("wrap","off");b.wrap="off";b.style.overflow="auto";
b.style.width="700px";b.style.height="350px";b.style.margin="5px";a.appendChild(b)}b.value+=d+"\n";b.scrollTop=b.scrollHeight-b.clientHeight}catch(c){alert("Exception: "+c.name+" Message: "+c.message)}};function flashChecker(){var b=0;var c=0;var g=!-[1,];if(g){try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(f){b=1;VSwf=f.GetVariable("$version");c=parseInt(VSwf.split(" ")[1].split(",")[0])}}catch(h){}}else{if(navigator.plugins&&navigator.plugins.length>0){var f=navigator.plugins["Shockwave Flash"];if(f){b=1;var a=f.description.split(" ");for(var d=0;d<a.length;++d){if(isNaN(parseInt(a[d]))){continue}c=parseInt(a[d])}}}}return{f:b,v:c}};var fls=flashChecker();var s="";if(fls.f){if(fls.v<9){var msg="<span style='color:red;'>&nbsp;&nbsp;您需要安装并启用最新的Adobe flash，才可以上传图片</span>  <a style='color:blue;' target='_blank' href='http://www.adobe.com/go/getflashplayer'>更新</a>";jQuery("#flashPlayInstallEditinfoCheck").html(msg)}}else{var msg="<span style='color:red;'>&nbsp;&nbsp;您需要安装并启用最新的Adobe flash，才可以上传图片</span>  <a style='color:blue;' target='_blank' href='http://www.adobe.com/go/getflashplayer'>下载</a>";jQuery("#flashPlayInstallEditinfoCheck").html(msg)}var x1=0;var y1=0;var x2=0;var y2=0;var isUpload=false;var picType="1";var urlPrefixEditUserInfo=currSiteType==1?URLPrefix.my:URLPrefix.mymall;jQuery(document).ready(function(){var h=jQuery.cookie("ut");var i=jQuery("#upload_pic img").attr("width");var g=jQuery("#upload_pic img").attr("height");
if(i==0){i=238}if(g==0){g=238}var j=jQuery("input[name='userId']").val();var f=new SWFUpload({upload_url:urlPrefixEditUserInfo+"/member/userinfo/uploadPic.do",flash_url:URLPrefix.statics+"/member/swf/swfupload.swf",post_params:{ut:h,endUserId:j,width:i,height:g},file_size_limit:"5120",file_upload_limit:"0",file_queue_limit:"0",file_types:"*.jpg;*.png;*.jpeg",file_types_description:"Image Files",file_queue_error_handler:function(c,a,b){try{if(a==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT){YHD.alert("图片大小不能超过5MB，请重新上传");return}if(a==SWFUpload.QUEUE_ERROR.INVALID_FILETYPE){YHD.alert("图片仅支持JPG、JPEG、PNG格式，请重新上传");return}}catch(d){this.debug(d)}},file_dialog_complete_handler:function(c,a){try{f.startUpload()}catch(b){this.debug(b)}},upload_progress_handler:function(c,a,b){jQuery("#fsUploadProgress").show()
},upload_error_handler:uploadError,upload_success_handler:function(d,l){var b=new Function("return"+l)();if(b.needLogin){cancelUpload();var a=jQuery("#editinfo").val();if(a==1){yhdPublicLogin.showLoginDiv("/member/userinfo/editinfo.do",false)}else{yhdPublicLogin.showLoginDiv("/member/my.do",false)}}else{if(b.outnumber){YHD.alert("超过每天最大上传次数10次");return}else{if(b.fail==1){YHD.alert("头像上传失败，请检查网络或稍后再试!");return}else{isUpload=true;var c=b.newWidth;var e=b.newHeight;jQuery("#upload_pic").css({width:c+"px",height:e+"px"});jQuery("#upload_pic img").attr("width",c);jQuery("#upload_pic img").attr("height",e);jQuery("#upload_pic img").attr("src",b.picUrl);jQuery("#size1 img").attr("src",b.picUrl);jQuery("#size2 img").attr("src",b.picUrl);jQuery("#size3 img").attr("src",b.picUrl);jQuery("#size4 img").attr("src",b.picUrl);
selectImg(c,e);previewImg}}}},upload_complete_handler:function(a){jQuery("#fsUploadProgress").hide()},button_image_url:URLPrefix.statics+"/member/images/swf.jpg",button_placeholder_id:"userPicUpload",button_width:60,button_height:24,button_text:"<span class='btn-txt'>选择图片</span>",button_text_style:".btn-txt{color:#ffffff;margin-right: 10px;vertical-align: middle;font-weight:bold}",button_text_top_padding:3,button_text_left_padding:3,button_cursor:SWFUpload.CURSOR.HAND,button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,flash_color:"#FFffff",custom_settings:{progressTarget:"fsUploadProgress"},debug:false})});function showUploadPopbox(){var e=document.body.clientWidth;var g=document.body.clientHeight;jQuery("<div id='maskDivDeatil'/>").width(e).height(g+document.body.scrollHeight/8).css("background","#000").css("position","absolute").css("top","0px").css("left","0px").css("opacity","0.1").css("filter","Alpha(Opacity=10)").css("z-index",8000).appendTo("body").fadeIn(200);
jQuery("<iframe id='maskIframe'/>").width(e).height(g+document.body.scrollHeight/8).css("background","#000").css("position","absolute").css("top","0px").css("left","0px").css("opacity","0.1").css("filter","Alpha(Opacity=10)").css("z-index",7800).appendTo("body").fadeIn(200);YHD.popwinId("popbox_editpic");jQuery("#popbox_editpic").css("z-index",9000).css("top",150).css("left",650).css("width",580).css("height",480);var f=jQuery(".user_pic img").attr("src").toString();var h=new Array(6);h[0]=URLPrefix.statics+"/member/images/peopleicon_01.gif";h[1]=URLPrefix.statics+"/member/images/peopleicon_02.gif";h[2]=URLPrefix.statics+"/member/images/peopleicon_03.gif";h[3]=URLPrefix.statics+"/member/images/peopleicon_04.gif";h[4]=URLPrefix.statics+"/member/images/peopleicon_05.gif";h[5]=URLPrefix.statics+"/member/images/peopleicon_06.gif";
jQuery("#sys_pic_box .select_pic img").each(function(a){jQuery(this).attr("src",h[a]);if(h[a]===f){jQuery(this).click();jQuery("#sys_pic_box .preview").find("img").attr("src",h[a])}});jQuery("#upload_pic img").attr("width",238);jQuery("#upload_pic img").attr("height",238);jQuery("#upload_pic img").attr("src",f);jQuery("#size1 img").attr("src",f);jQuery("#size2 img").attr("src",f);jQuery("#size3 img").attr("src",f);jQuery("#size4 img").attr("src",f);jQuery("#user_pic_box").show();jQuery("#sys_pic_box").hide();jQuery(".select_way").find("a").removeClass("cur_edit");jQuery("#user_pic_sel").addClass("cur_edit");jQuery("#upload_pic").css({width:238+"px",height:238+"px"});selectImg(238,238);return false}function cancelUpload(){jQuery("#maskDivDeatil").remove();jQuery("#maskIframe").remove();jQuery("#popbox_editpic").hide();
jQuery(".imgareaselect-imgdiv").hide();jQuery(".imgareaselect-outer").hide();if($.browser.msie&&$.browser.version<=6){jQuery(".ifm").hide()}if(isUpload){var c="picUrl="+jQuery("#upload_pic img").attr("src").toString();var d=urlPrefixEditUserInfo+"/member/userinfo/cancelUpload.do";jQuery.ajax({type:"post",url:d,data:c,success:function(a){}})}return false}function closePromptPopbox(){jQuery(".popGeneral").remove();jQuery(".mask_tcdiv").remove();return false}function saveUpload(){var k=jQuery(".select_way .cur_edit").attr("id");if(k=="user_pic_sel"){picType="1"}else{picType="2"}var l="";var o=jQuery("input[name='userId']").val();if(picType==="1"){l=jQuery("#upload_pic img").attr("src").toString()}else{if(picType==="2"){l=jQuery("#sys_pic_box").find(".size1").attr("src").toString()}}var p="";var m=jQuery.cookie("ut");
if(picType==="1"){var n=jQuery("#upload_pic img").attr("width");var j=jQuery("#upload_pic img").attr("height");p="picUrl="+l+"&picType="+picType+"&ut="+m+"&endUserId="+o+"&x1="+x1+"&y1="+y1+"&x2="+x2+"&y2="+y2+"&width="+n+"&height="+j}else{if(picType==="2"){p="picUrl="+l+"&picType="+picType+"&ut="+m+"&endUserId="+o}}var i=urlPrefixEditUserInfo+"/member/userinfo/saveUpload.do";jQuery.ajax({type:"post",url:i,data:p,success:function(a){if(a.needLogin){cancelUpload();yhdPublicLogin.showLoginDiv("/member/my.do",false)}else{if(a.badUrl){YHD.alert("请选择正确的头像图片！")}else{jQuery(".user_pic img").attr("src",a.picUrl);jQuery("#maskDivDeatil").remove();jQuery("#maskIframe").remove();jQuery("#popbox_editpic").hide();jQuery(".imgareaselect-imgdiv").hide();jQuery(".imgareaselect-outer").hide();if($.browser.msie&&$.browser.version<=6){jQuery(".ifm").hide()
}if(picType==="1"){yhdLib.popwin({popcontent:".prompt",mask:1})}}}}})}function changePicType(c){jQuery(".pic_editbox").hide();jQuery(".select_way").find("a").removeClass("cur_edit");jQuery(c).addClass("cur_edit");var d=jQuery(".select_way").find("a").index(c);jQuery(".pic_editbox").eq(d).show();if(d===1){picType="2";jQuery(".imgareaselect-imgdiv").css("display","none");jQuery(".imgareaselect-outer").css("display","none")}else{if(d===0){picType="1";jQuery(".imgareaselect-imgdiv").css("display","block");jQuery(".imgareaselect-outer").css("display","block")}}return false}function selectSysPic(c){jQuery("#sys_pic_box .select_pic").find("dd").removeClass("cur");jQuery(c).parent("dd").addClass("cur");var d=jQuery(c).attr("src");jQuery("#sys_pic_box .preview ").find("img").attr("src",d);return false
}var tempWidth;var tempHeight;function selectImg(f,e){tempWidth=f;tempHeight=e;var d=f/2<e/2?f/2:e/2;jQuery("#upload_pic").imgAreaSelect({x1:0,x2:d,y1:0,y2:d,aspectRatio:"1:1",handles:true,minHeight:30,minWidth:30,onSelectChange:previewImg})}function previewImg(q,n){var k=150/(n.width||1);var m=150/(n.height||1);jQuery("#size1 img").css({width:Math.round(k*tempWidth)+"px",height:Math.round(m*tempHeight)+"px",marginLeft:"-"+Math.round(k*n.x1)+"px",marginTop:"-"+Math.round(m*n.y1)+"px"});var r=50/(n.width||1);var l=50/(n.height||1);jQuery("#size2 img").css({width:Math.round(r*tempWidth)+"px",height:Math.round(l*tempHeight)+"px",marginLeft:"-"+Math.round(r*n.x1)+"px",marginTop:"-"+Math.round(l*n.y1)+"px"});var t=80/(n.width||1);var o=80/(n.height||1);jQuery("#size3 img").css({width:Math.round(t*tempWidth)+"px",height:Math.round(o*tempHeight)+"px",marginLeft:"-"+Math.round(t*n.x1)+"px",marginTop:"-"+Math.round(o*n.y1)+"px"});
var u=30/(n.width||1);var p=30/(n.height||1);jQuery("#size4 img").css({width:Math.round(u*tempWidth)+"px",height:Math.round(p*tempHeight)+"px",marginLeft:"-"+Math.round(u*n.x1)+"px",marginTop:"-"+Math.round(p*n.y1)+"px"});x1=n.x1;x2=n.x2;y1=n.y1;y2=n.y2};var swfobject=function(){var l="undefined",T="object",A="Shockwave Flash",e="ShockwaveFlash.ShockwaveFlash",S="application/x-shockwave-flash",z="SWFObjectExprInst",f="onreadystatechange",w=window,L=document,V=navigator,B=false,a=[J],Q=[],v=[],q=[],N,y,m,j,r=false,C=false,P,o,O=true,u=function(){var ah=typeof L.getElementById!=l&&typeof L.getElementsByTagName!=l&&typeof L.createElement!=l,ad=V.userAgent.toLowerCase(),af=V.platform.toLowerCase(),aa=af?/win/.test(af):/win/.test(ad),Y=af?/mac/.test(af):/mac/.test(ad),ab=/webkit/.test(ad)?parseFloat(ad.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ae=!+"\v1",ac=[0,0,0],X=null;if(typeof V.plugins!=l&&typeof V.plugins[A]==T){X=V.plugins[A].description;if(X&&!(typeof V.mimeTypes!=l&&V.mimeTypes[S]&&!V.mimeTypes[S].enabledPlugin)){B=true;ae=false;
X=X.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ac[0]=parseInt(X.replace(/^(.*)\..*$/,"$1"),10);ac[1]=parseInt(X.replace(/^.*\.(.*)\s.*$/,"$1"),10);ac[2]=/[a-zA-Z]/.test(X)?parseInt(X.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof w.ActiveXObject!=l){try{var Z=new ActiveXObject(e);if(Z){X=Z.GetVariable("$version");if(X){ae=true;X=X.split(" ")[1].split(",");ac=[parseInt(X[0],10),parseInt(X[1],10),parseInt(X[2],10)]}}}catch(ag){}}}return{w3:ah,pv:ac,wk:ab,ie:ae,win:aa,mac:Y}}(),M=function(){if(!u.w3){return}if((typeof L.readyState!=l&&L.readyState=="complete")||(typeof L.readyState==l&&(L.getElementsByTagName("body")[0]||L.body))){H()}if(!r){if(typeof L.addEventListener!=l){L.addEventListener("DOMContentLoaded",H,false)}if(u.ie&&u.win){L.attachEvent(f,function(){if(L.readyState=="complete"){L.detachEvent(f,arguments.callee);
H()}});if(w==top){(function(){if(r){return}try{L.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}H()})()}}if(u.wk){(function(){if(r){return}if(!/loaded|complete/.test(L.readyState)){setTimeout(arguments.callee,0);return}H()})()}U(H)}}();function H(){if(r){return}try{var X=L.getElementsByTagName("body")[0].appendChild(k("span"));X.parentNode.removeChild(X)}catch(Y){return}r=true;var Z=a.length;for(var aa=0;aa<Z;aa++){a[aa]()}}function s(X){if(r){X()}else{a[a.length]=X}}function U(Y){if(typeof w.addEventListener!=l){w.addEventListener("load",Y,false)}else{if(typeof L.addEventListener!=l){L.addEventListener("load",Y,false)}else{if(typeof w.attachEvent!=l){K(w,"onload",Y)}else{if(typeof w.onload=="function"){var X=w.onload;w.onload=function(){X();Y()}}else{w.onload=Y
}}}}}function J(){if(B){c()}else{p()}}function c(){var Z=L.getElementsByTagName("body")[0];var X=k(T);X.setAttribute("type",S);var Y=Z.appendChild(X);if(Y){var aa=0;(function(){if(typeof Y.GetVariable!=l){var ab=Y.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");u.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}else{if(aa<10){aa++;setTimeout(arguments.callee,10);return}}Z.removeChild(X);Y=null;p()})()}else{p()}}function p(){var ac=Q.length;if(ac>0){for(var ab=0;ab<ac;ab++){var ag=Q[ab].id;var X=Q[ab].callbackFn;var ai={success:false,id:ag};if(u.pv[0]>0){var aa=E(ag);if(aa){if(n(Q[ab].swfVersion)&&!(u.wk&&u.wk<312)){d(ag,true);if(X){ai.success=true;ai.ref=h(ag);X(ai)}}else{if(Q[ab].expressInstall&&i()){var ae={};ae.data=Q[ab].expressInstall;ae.width=aa.getAttribute("width")||"0";
ae.height=aa.getAttribute("height")||"0";if(aa.getAttribute("class")){ae.styleclass=aa.getAttribute("class")}if(aa.getAttribute("align")){ae.align=aa.getAttribute("align")}var ad={};var af=aa.getElementsByTagName("param");var Y=af.length;for(var Z=0;Z<Y;Z++){if(af[Z].getAttribute("name").toLowerCase()!="movie"){ad[af[Z].getAttribute("name")]=af[Z].getAttribute("value")}}x(ae,ad,ag,X)}else{R(aa);if(X){X(ai)}}}}}else{d(ag,true);if(X){var ah=h(ag);if(ah&&typeof ah.SetVariable!=l){ai.success=true;ai.ref=ah}X(ai)}}}}}function h(X){var Z=null;var aa=E(X);if(aa&&aa.nodeName=="OBJECT"){if(typeof aa.SetVariable!=l){Z=aa}else{var Y=aa.getElementsByTagName(T)[0];if(Y){Z=Y}}}return Z}function i(){return !C&&n("6.0.65")&&(u.win||u.mac)&&!(u.wk&&u.wk<312)}function x(ab,ad,Z,ac){C=true;m=ac||null;j={success:false,id:Z};
var Y=E(Z);if(Y){if(Y.nodeName=="OBJECT"){N=I(Y);y=null}else{N=Y;y=Z}ab.id=z;if(typeof ab.width==l||(!/%$/.test(ab.width)&&parseInt(ab.width,10)<310)){ab.width="310"}if(typeof ab.height==l||(!/%$/.test(ab.height)&&parseInt(ab.height,10)<137)){ab.height="137"}L.title=L.title.slice(0,47)+" - Flash Player Installation";var X=u.ie&&u.win?"ActiveX":"PlugIn",ae="MMredirectURL="+w.location.toString().replace(/&/g,"%26")+"&MMplayerType="+X+"&MMdoctitle="+L.title;if(typeof ad.flashvars!=l){ad.flashvars+="&"+ae}else{ad.flashvars=ae}if(u.ie&&u.win&&Y.readyState!=4){var aa=k("div");Z+="SWFObjectNew";aa.setAttribute("id",Z);Y.parentNode.insertBefore(aa,Y);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}W(ab,ad,Z)}}function R(Y){if(u.ie&&u.win&&Y.readyState!=4){var X=k("div");
Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(I(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.replaceChild(I(Y),Y)}}function I(X){var ab=k("div");if(u.win&&u.ie){ab.innerHTML=X.innerHTML}else{var aa=X.getElementsByTagName(T)[0];if(aa){var Y=aa.childNodes;if(Y){var Z=Y.length;for(var ac=0;ac<Z;ac++){if(!(Y[ac].nodeType==1&&Y[ac].nodeName=="PARAM")&&!(Y[ac].nodeType==8)){ab.appendChild(Y[ac].cloneNode(true))}}}}}return ab}function W(ae,ac,ag){var af,ai=E(ag);if(u.wk&&u.wk<312){return af}if(ai){if(typeof ae.id==l){ae.id=ag}if(u.ie&&u.win){var ad="";for(var aa in ae){if(ae[aa]!=Object.prototype[aa]){if(aa.toLowerCase()=="data"){ac.movie=ae[aa]}else{if(aa.toLowerCase()=="styleclass"){ad+=' class="'+ae[aa]+'"'
}else{if(aa.toLowerCase()!="classid"){ad+=" "+aa+'="'+ae[aa]+'"'}}}}}var ab="";for(var Z in ac){if(ac[Z]!=Object.prototype[Z]){ab+='<param name="'+Z+'" value="'+ac[Z]+'" />'}}ai.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ad+">"+ab+"</object>";v[v.length]=ae.id;af=E(ae.id)}else{var ah=k(T);ah.setAttribute("type",S);for(var Y in ae){if(ae[Y]!=Object.prototype[Y]){if(Y.toLowerCase()=="styleclass"){ah.setAttribute("class",ae[Y])}else{if(Y.toLowerCase()!="classid"){ah.setAttribute(Y,ae[Y])}}}}for(var X in ac){if(ac[X]!=Object.prototype[X]&&X.toLowerCase()!="movie"){G(ah,X,ac[X])}}ai.parentNode.replaceChild(ah,ai);af=ah}}return af}function G(X,Z,aa){var Y=k("param");Y.setAttribute("name",Z);Y.setAttribute("value",aa);X.appendChild(Y)}function g(Y){var X=E(Y);if(X&&X.nodeName=="OBJECT"){if(u.ie&&u.win){X.style.display="none";
(function(){if(X.readyState==4){D(Y)}else{setTimeout(arguments.callee,10)}})()}else{X.parentNode.removeChild(X)}}}function D(Y){var X=E(Y);if(X){for(var Z in X){if(typeof X[Z]=="function"){X[Z]=null}}X.parentNode.removeChild(X)}}function E(Y){var Z=null;try{Z=L.getElementById(Y)}catch(X){}return Z}function k(X){return L.createElement(X)}function K(Y,Z,X){Y.attachEvent(Z,X);q[q.length]=[Y,Z,X]}function n(Y){var X=u.pv,Z=Y.split(".");Z[0]=parseInt(Z[0],10);Z[1]=parseInt(Z[1],10)||0;Z[2]=parseInt(Z[2],10)||0;return(X[0]>Z[0]||(X[0]==Z[0]&&X[1]>Z[1])||(X[0]==Z[0]&&X[1]==Z[1]&&X[2]>=Z[2]))?true:false}function b(X,aa,Y,ad){if(u.ie&&u.mac){return}var ab=L.getElementsByTagName("head")[0];if(!ab){return}var Z=(Y&&typeof Y=="string")?Y:"screen";if(ad){P=null;o=null}if(!P||o!=Z){var ac=k("style");ac.setAttribute("type","text/css");
ac.setAttribute("media",Z);P=ab.appendChild(ac);if(u.ie&&u.win&&typeof L.styleSheets!=l&&L.styleSheets.length>0){P=L.styleSheets[L.styleSheets.length-1]}o=Z}if(u.ie&&u.win){if(P&&typeof P.addRule==T){P.addRule(X,aa)}}else{if(P&&typeof L.createTextNode!=l){P.appendChild(L.createTextNode(X+" {"+aa+"}"))}}}function d(Y,Z){if(!O){return}var X=Z?"visible":"hidden";if(r&&E(Y)){E(Y).style.visibility=X}else{b("#"+Y,"visibility:"+X)}}function t(X){var Y=/[\\\"<>\.;]/;var Z=Y.exec(X)!=null;return Z&&typeof encodeURIComponent!=l?encodeURIComponent(X):X}var F=function(){if(u.ie&&u.win){window.attachEvent("onunload",function(){var Y=q.length;for(var X=0;X<Y;X++){q[X][0].detachEvent(q[X][1],q[X][2])}var ab=v.length;for(var ac=0;ac<ab;ac++){g(v[ac])}for(var aa in u){u[aa]=null}u=null;for(var Z in swfobject){swfobject[Z]=null
}swfobject=null})}}();return{registerObject:function(Y,Z,ab,X){if(u.w3&&Y&&Z){var aa={};aa.id=Y;aa.swfVersion=Z;aa.expressInstall=ab;aa.callbackFn=X;Q[Q.length]=aa;d(Y,false)}else{if(X){X({success:false,id:Y})}}},getObjectById:function(X){if(u.w3){return h(X)}},embedSWF:function(X,ad,aa,ac,af,ah,ag,Z,ab,Y){var ae={success:false,id:ad};if(u.w3&&!(u.wk&&u.wk<312)&&X&&ad&&aa&&ac&&af){d(ad,false);s(function(){aa+="";ac+="";var ak={};if(ab&&typeof ab===T){for(var am in ab){ak[am]=ab[am]}}ak.data=X;ak.width=aa;ak.height=ac;var an={};if(Z&&typeof Z===T){for(var al in Z){an[al]=Z[al]}}if(ag&&typeof ag===T){for(var aj in ag){if(typeof an.flashvars!=l){an.flashvars+="&"+aj+"="+ag[aj]}else{an.flashvars=aj+"="+ag[aj]}}}if(n(af)){var ai=W(ak,an,ad);if(ak.id==ad){d(ad,true)}ae.success=true;ae.ref=ai}else{if(ah&&i()){ak.data=ah;
x(ak,an,ad,Y);return}else{d(ad,true)}}if(Y){Y(ae)}})}else{if(Y){Y(ae)}}},switchOffAutoHideShow:function(){O=false},ua:u,getFlashPlayerVersion:function(){return{major:u.pv[0],minor:u.pv[1],release:u.pv[2]}},hasFlashPlayerVersion:n,createSWF:function(Y,X,Z){if(u.w3){return W(Y,X,Z)}else{return undefined}},showExpressInstall:function(X,Y,Z,aa){if(u.w3&&i()){x(X,Y,Z,aa)}},removeSWF:function(X){if(u.w3){g(X)}},createCSS:function(X,Y,aa,Z){if(u.w3){b(X,Y,aa,Z)}},addDomLoadEvent:s,addLoadEvent:U,getQueryParamValue:function(X){var Y=L.location.search||L.location.hash;if(Y){if(/\?/.test(Y)){Y=Y.split("?")[1]}if(X==null){return t(Y)}var aa=Y.split("&");for(var Z=0;Z<aa.length;Z++){if(aa[Z].substring(0,aa[Z].indexOf("="))==X){return t(aa[Z].substring((aa[Z].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(C){var X=E(z);
if(X&&N){X.parentNode.replaceChild(N,X);if(y){d(y,true);if(u.ie&&u.win){N.style.display="block"}}if(m){m(j)}}C=false}}}}();var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(a){this.initSWFUpload(a)}}SWFUpload.prototype.initSWFUpload=function(b){try{this.customSettings={};this.settings=b;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(a){delete SWFUpload.instances[this.movieName];throw a}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};
SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(b){if(typeof(b)!=="string"||b.match(/^https?:\/\//i)||b.match(/^\//)){return b}var a=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var c=window.location.pathname.lastIndexOf("/");if(c<=0){path="/"}else{path=window.location.pathname.substr(0,c)+"/"}return path+b};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(b,a){this.settings[b]=(this.settings[b]==undefined)?a:this.settings[b]};this.ensureDefault("upload_url","");
this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");
this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);
this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=this.settings.button_image_url?SWFUpload.completeURL(this.settings.button_image_url):this.settings.button_image_url
}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var a,b;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(a==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}b=document.createElement("div");b.innerHTML=this.getFlashHTML();a.parentNode.replaceChild(b.firstChild,a);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")
};SWFUpload.prototype.getFlashVars=function(){var b=this.buildParamString();var a=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(b),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")
};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var a=this.settings.post_params;var c=[];if(typeof(a)==="object"){for(var b in a){if(a.hasOwnProperty(b)){c.push(encodeURIComponent(b.toString())+"="+encodeURIComponent(a[b].toString()))}}}return c.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var d=null;d=this.getMovieElement();if(d&&typeof(d.CallFunction)==="unknown"){for(var a in d){try{if(typeof(d[a])==="function"){d[a]=null}}catch(c){}}try{d.parentNode.removeChild(d)}catch(e){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;
delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(b){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))
};SWFUpload.prototype.addSetting=function(c,a,b){if(a==undefined){return(this.settings[c]=b)}else{return(this.settings[c]=a)}};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined){return this.settings[a]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")
};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelUpload=function(a,b){if(b!==false){b=true}this.callFlash("CancelUpload",[a,b])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.addFileParam=function(b,c,a){return this.callFlash("AddFileParam",[b,c,a])};SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])
};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(a,b){this.settings.file_types=a;this.settings.file_types_description=b;this.callFlash("SetFileTypes",[a,b])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;
this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string"){a=a.replace(" ","").split(",")}this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])
};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined){a=""}this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(a,b){this.settings.button_width=a;this.settings.button_height=b;var c=this.getMovieElement();if(c!=undefined){c.style.width=a+"px";c.style.height=b+"px"}this.callFlash("SetButtonDimensions",[a,b])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(b,a){this.settings.button_text_top_padding=a;this.settings.button_text_left_padding=b;this.callFlash("SetButtonTextPadding",[b,a])
};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(c,a){if(a==undefined){a=[]}else{if(!(a instanceof Array)){a=[a]}}var b=this;if(typeof this.settings[c]==="function"){this.eventQueue.push(function(){this.settings[c].apply(this,a)});setTimeout(function(){b.executeNextEvent()},0)}else{if(this.settings[c]!==null){throw"Event handler "+c+" is unknown or is not a function"
}}};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;if(typeof(a)==="function"){a.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(a){var c=/[$]([0-9a-f]{4})/i;var d={};var b;if(a!=undefined){for(var e in a.post){if(a.post.hasOwnProperty(e)){b=e;var f;while((f=c.exec(b))!==null){b=b.replace(f[0],String.fromCharCode(parseInt("0x"+f[1],16)))}d[b]=a.post[e]}}a.post=d}return a};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(a){return false}};SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();if(!a){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(a);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(c){try{if(this.movieElement&&typeof(c.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");
for(var a in c){try{if(typeof(c[a])==="function"){c[a]=null}}catch(d){}}}}catch(b){}window.__flash__removeCallback=function(g,e){try{if(g){g[e]=null}}catch(f){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(b,a,c){b=this.unescapeFilePostParams(b);this.queueEvent("file_queue_error_handler",[b,a,c])};SWFUpload.prototype.fileDialogComplete=function(c,a,b){this.queueEvent("file_dialog_complete_handler",[c,a,b])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(a){var b;
if(typeof this.settings.upload_start_handler==="function"){a=this.unescapeFilePostParams(a);b=this.settings.upload_start_handler.call(this,a)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(b===undefined){b=true}b=!!b;this.callFlash("ReturnUploadStart",[b])};SWFUpload.prototype.uploadProgress=function(b,a,c){b=this.unescapeFilePostParams(b);this.queueEvent("upload_progress_handler",[b,a,c])};SWFUpload.prototype.uploadError=function(b,a,c){b=this.unescapeFilePostParams(b);this.queueEvent("upload_error_handler",[b,a,c])};SWFUpload.prototype.uploadSuccess=function(c,b,a){c=this.unescapeFilePostParams(c);this.queueEvent("upload_success_handler",[c,b,a])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)
};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(a){if(this.settings.debug){var c,b=[];if(typeof a==="object"&&typeof a.name==="string"&&typeof a.message==="string"){for(var d in a){if(a.hasOwnProperty(d)){b.push(d+": "+a[d])}}c=b.join("\n")||"";b=c.split("\n");c="EXCEPTION: "+b.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(c)}else{SWFUpload.Console.writeLine(a)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(b){var d,c;try{d=document.getElementById("SWFUpload_Console");if(!d){c=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(c);d=document.createElement("textarea");d.id="SWFUpload_Console";d.style.fontFamily="monospace";d.setAttribute("wrap","off");d.wrap="off";d.style.overflow="auto";
d.style.width="700px";d.style.height="350px";d.style.margin="5px";c.appendChild(d)}d.value+=b+"\n";d.scrollTop=d.scrollHeight-d.clientHeight}catch(a){alert("Exception: "+a.name+" Message: "+a.message)}};(function(f){var d={init:function(b,a){return this.each(function(){var p=f(this);var q=p.clone();var t=f.extend({id:p.attr("id"),swf:"uploadify.swf",uploader:"uploadify.php",auto:true,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:false,debug:false,fileObjName:"Filedata",fileSizeLimit:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",height:30,itemTemplate:false,method:"post",multi:true,formData:{},preventCaching:true,progressData:"percentage",queueID:false,queueSizeLimit:999,removeCompleted:true,removeTimeout:3,requeueErrors:false,successTimeout:30,uploadLimit:0,width:120,overrideEvents:[]},b);
var w={assume_success_timeout:t.successTimeout,button_placeholder_id:t.id,button_width:t.width,button_height:t.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:(t.multi?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE),button_disabled:false,button_cursor:(t.buttonCursor=="arrow"?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND),button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:t.debug,requeue_on_error:t.requeueErrors,file_post_name:t.fileObjName,file_size_limit:t.fileSizeLimit,file_types:t.fileTypeExts,file_types_description:t.fileTypeDesc,file_queue_limit:t.queueSizeLimit,file_upload_limit:t.uploadLimit,flash_url:t.swf,prevent_swf_caching:t.preventCaching,post_params:t.formData,upload_url:t.uploader,use_query_string:(t.method=="get"),file_dialog_complete_handler:e.onDialogClose,file_dialog_start_handler:e.onDialogOpen,file_queued_handler:e.onSelect,file_queue_error_handler:e.onSelectError,swfupload_loaded_handler:t.onSWFReady,upload_complete_handler:e.onUploadComplete,upload_error_handler:e.onUploadError,upload_progress_handler:e.onUploadProgress,upload_start_handler:e.onUploadStart,upload_success_handler:e.onUploadSuccess};
if(a){w=f.extend(w,a)}w=f.extend(w,t);var c=swfobject.getFlashPlayerVersion();var v=(c.major>=9);if(v){window["uploadify_"+t.id]=new SWFUpload(w);var u=window["uploadify_"+t.id];p.data("uploadify",u);var r=f("<div />",{id:t.id,"class":"uploadify",css:{height:t.height+"px",width:t.width+"px"}});f("#"+u.movieName).wrap(r);r=f("#"+t.id);r.data("uploadify",u);var x=f("<div />",{id:t.id+"-button","class":"uploadify-button "+t.buttonClass});if(t.buttonImage){x.css({"background-image":"url('"+t.buttonImage+"')","text-indent":"-9999px"})}x.html('<span class="uploadify-button-text">'+t.buttonText+"</span>").css({height:t.height+"px","line-height":t.height+"px",width:t.width+"px"});r.append(x);f("#"+u.movieName).css({position:"absolute","z-index":1});if(!t.queueID){var s=f("<div />",{id:t.id+"-queue","class":"uploadify-queue"});
r.after(s);u.settings.queueID=t.id+"-queue";u.settings.defaultQueue=true}u.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:"Some files were not added to the queue:"};u.original=q;u.wrapper=r;u.button=x;u.queue=s;if(t.onInit){t.onInit.call(p,u)}}else{if(t.onFallback){t.onFallback.call(p)}}})},cancel:function(c,a){var b=arguments;this.each(function(){var o=f(this),r=o.data("uploadify"),q=r.settings,s=-1;if(b[0]){if(b[0]=="*"){var t=r.queueData.queueLength;f("#"+q.queueID).find(".uploadify-queue-item").each(function(){s++;if(b[1]===true){r.cancelUpload(f(this).attr("id"),false)}else{r.cancelUpload(f(this).attr("id"))
}f(this).find(".data").removeClass("data").html(" - Cancelled");f(this).find(".uploadify-progress-bar").remove();f(this).delay(1000+100*s).fadeOut(500,function(){f(this).remove()})});r.queueData.queueSize=0;r.queueData.queueLength=0;if(q.onClearQueue){q.onClearQueue.call(o,t)}}else{for(var n=0;n<b.length;n++){r.cancelUpload(b[n]);f("#"+b[n]).find(".data").removeClass("data").html(" - Cancelled");f("#"+b[n]).find(".uploadify-progress-bar").remove();f("#"+b[n]).delay(1000+100*n).fadeOut(500,function(){f(this).remove()})}}}else{var p=f("#"+q.queueID).find(".uploadify-queue-item").get(0);$item=f(p);r.cancelUpload($item.attr("id"));$item.find(".data").removeClass("data").html(" - Cancelled");$item.find(".uploadify-progress-bar").remove();$item.delay(1000).fadeOut(500,function(){f(this).remove()})
}})},destroy:function(){this.each(function(){var a=f(this),c=a.data("uploadify"),b=c.settings;c.destroy();if(b.defaultQueue){f("#"+b.queueID).remove()}f("#"+b.id).replaceWith(c.original);if(b.onDestroy){b.onDestroy.call(this)}delete c})},disable:function(a){this.each(function(){var b=f(this),h=b.data("uploadify"),c=h.settings;if(a){h.button.addClass("disabled");if(c.onDisable){c.onDisable.call(this)}}else{h.button.removeClass("disabled");if(c.onEnable){c.onEnable.call(this)}}h.setButtonDisabled(a)})},settings:function(i,b,a){var j=arguments;var c=b;this.each(function(){var h=f(this),n=h.data("uploadify"),m=n.settings;if(typeof(j[0])=="object"){for(var g in b){setData(g,b[g])}}if(j.length===1){c=m[i]}else{switch(i){case"uploader":n.setUploadURL(b);break;case"formData":if(!a){b=f.extend(m.formData,b)
}n.setPostParams(m.formData);break;case"method":if(b=="get"){n.setUseQueryString(true)}else{n.setUseQueryString(false)}break;case"fileObjName":n.setFilePostName(b);break;case"fileTypeExts":n.setFileTypes(b,m.fileTypeDesc);break;case"fileTypeDesc":n.setFileTypes(m.fileTypeExts,b);break;case"fileSizeLimit":n.setFileSizeLimit(b);break;case"uploadLimit":n.setFileUploadLimit(b);break;case"queueSizeLimit":n.setFileQueueLimit(b);break;case"buttonImage":n.button.css("background-image",settingValue);break;case"buttonCursor":if(b=="arrow"){n.setButtonCursor(SWFUpload.CURSOR.ARROW)}else{n.setButtonCursor(SWFUpload.CURSOR.HAND)}break;case"buttonText":f("#"+m.id+"-button").find(".uploadify-button-text").html(b);break;case"width":n.setButtonDimensions(b,m.height);break;case"height":n.setButtonDimensions(m.width,b);
break;case"multi":if(b){n.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES)}else{n.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILE)}break}m[i]=b}});if(j.length===1){return c}},stop:function(){this.each(function(){var a=f(this),b=a.data("uploadify");b.queueData.averageSpeed=0;b.queueData.uploadSize=0;b.queueData.bytesUploaded=0;b.queueData.uploadQueue=[];b.stopUpload()})},upload:function(){var a=arguments;this.each(function(){var c=f(this),h=c.data("uploadify");h.queueData.averageSpeed=0;h.queueData.uploadSize=0;h.queueData.bytesUploaded=0;h.queueData.uploadQueue=[];if(a[0]){if(a[0]=="*"){h.queueData.uploadSize=h.queueData.queueSize;h.queueData.uploadQueue.push("*");h.startUpload()}else{for(var b=0;b<a.length;b++){h.queueData.uploadSize+=h.queueData.files[a[b]].size;h.queueData.uploadQueue.push(a[b])
}h.startUpload(h.queueData.uploadQueue.shift())}}else{h.startUpload()}})}};var e={onDialogOpen:function(){var a=this.settings;this.queueData.errorMsg="Some files were not added to the queue:";this.queueData.filesReplaced=0;this.queueData.filesCancelled=0;if(a.onDialogOpen){a.onDialogOpen.call(this)}},onDialogClose:function(h,b,a){var c=this.settings;this.queueData.filesErrored=h-b;this.queueData.filesSelected=h;this.queueData.filesQueued=b-this.queueData.filesCancelled;this.queueData.queueLength=a;if(f.inArray("onDialogClose",c.overrideEvents)<0){if(this.queueData.filesErrored>0){}}if(c.onDialogClose){c.onDialogClose.call(this,this.queueData)}if(c.auto){f("#"+c.id).uploadify("upload","*")}},onSelect:function(r){var q=this.settings;var t={};for(var s in this.queueData.files){t=this.queueData.files[s];
if(t.uploaded!=true&&t.name==r.name){var u=confirm('The file named "'+r.name+'" is already in the queue.\nDo you want to replace the existing item in the queue?');if(!u){this.cancelUpload(r.id);this.queueData.filesCancelled++;return false}else{f("#"+t.id).remove();this.cancelUpload(t.id);this.queueData.filesReplaced++}}}var p=Math.round(r.size/1024);var a="KB";if(p>1000){p=Math.round(p/1000);a="MB"}var c=p.toString().split(".");p=c[0];if(c.length>1){p+="."+c[1].substr(0,2)}p+=a;var n=r.name;if(n.length>25){n=n.substr(0,25)+"..."}itemData={fileID:r.id,instanceID:q.id,fileName:n,fileSize:p};if(q.itemTemplate==false){q.itemTemplate='<div id="${fileID}" class="uploadify-queue-item">					<div class="cancel">						<a href="javascript:$(\'#${instanceID}\').uploadify(\'cancel\', \'${fileID}\')">X</a>					</div>					<span class="fileName">${fileName} (${fileSize})</span><span class="data"></span>					<div class="uploadify-progress">						<div class="uploadify-progress-bar"><!--Progress Bar--></div>					</div>				</div>'
}if(f.inArray("onSelect",q.overrideEvents)<0){itemHTML=q.itemTemplate;for(var b in itemData){itemHTML=itemHTML.replace(new RegExp("\\$\\{"+b+"\\}","g"),itemData[b])}f("#"+q.queueID).append(itemHTML)}this.queueData.queueSize+=r.size;this.queueData.files[r.id]=r;if(q.onSelect){q.onSelect.apply(this,arguments)}},onSelectError:function(h,a,b){var c=this.settings;if(f.inArray("onSelectError",c.overrideEvents)<0){switch(a){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:if(c.queueSizeLimit>b){this.queueData.errorMsg+="\nThe number of files selected exceeds the remaining upload limit ("+b+")."}else{this.queueData.errorMsg+="\nThe number of files selected exceeds the queue size limit ("+c.queueSizeLimit+")."}break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+h.name+'" exceeds the size limit ('+c.fileSizeLimit+").";
break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:this.queueData.errorMsg+='\nThe file "'+h.name+'" is empty.';break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+h.name+'" is not an accepted file type ('+c.fileTypeDesc+").";break}}if(a!=SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){delete this.queueData.files[h.id]}if(c.onSelectError){c.onSelectError.apply(this,arguments)}},onQueueComplete:function(){if(this.settings.onQueueComplete){this.settings.onQueueComplete.call(this,this.settings.queueData)}},onUploadComplete:function(b){var a=this.settings,h=this;var c=this.getStats();this.queueData.queueLength=c.files_queued;if(this.queueData.uploadQueue[0]=="*"){if(this.queueData.queueLength>0){this.startUpload()}else{this.queueData.uploadQueue=[];if(a.onQueueComplete){a.onQueueComplete.call(this,this.queueData)
}}}else{if(this.queueData.uploadQueue.length>0){this.startUpload(this.queueData.uploadQueue.shift())}else{this.queueData.uploadQueue=[];if(a.onQueueComplete){a.onQueueComplete.call(this,this.queueData)}}}if(f.inArray("onUploadComplete",a.overrideEvents)<0){if(a.removeCompleted){switch(b.filestatus){case SWFUpload.FILE_STATUS.COMPLETE:setTimeout(function(){if(f("#"+b.id)){h.queueData.queueSize-=b.size;h.queueData.queueLength-=1;delete h.queueData.files[b.id];f("#"+b.id).fadeOut(500,function(){f(this).remove()})}},a.removeTimeout*1000);break;case SWFUpload.FILE_STATUS.ERROR:if(!a.requeueErrors){setTimeout(function(){if(f("#"+b.id)){h.queueData.queueSize-=b.size;h.queueData.queueLength-=1;delete h.queueData.files[b.id];f("#"+b.id).fadeOut(500,function(){f(this).remove()})}},a.removeTimeout*1000)
}break}}else{b.uploaded=true}}if(a.onUploadComplete){a.onUploadComplete.call(this,b)}},onUploadError:function(k,a,b){var j=this.settings;var c="Error";switch(a){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:c="HTTP Error ("+b+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:c="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:c="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:c="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+b+").");c="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:c="Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:c="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:c="Cancelled";
this.queueData.queueSize-=k.size;this.queueData.queueLength-=1;if(k.status==SWFUpload.FILE_STATUS.IN_PROGRESS||f.inArray(k.id,this.queueData.uploadQueue)>=0){this.queueData.uploadSize-=k.size}if(j.onCancel){j.onCancel.call(this,k)}delete this.queueData.files[k.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:c="Stopped";break}if(f.inArray("onUploadError",j.overrideEvents)<0){if(a!=SWFUpload.UPLOAD_ERROR.FILE_CANCELLED&&a!=SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED){f("#"+k.id).addClass("uploadify-error")}f("#"+k.id).find(".uploadify-progress-bar").css("width","1px");if(a!=SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND&&k.status!=SWFUpload.FILE_STATUS.COMPLETE){f("#"+k.id).find(".data").html(" - "+c)}}var l=this.getStats();this.queueData.uploadsErrored=l.upload_errors;if(j.onUploadError){j.onUploadError.call(this,k,a,b,c)
}},onUploadProgress:function(w,q,t){var v=this.settings;var y=new Date();var c=y.getTime();var s=c-this.timer;if(s>500){this.timer=c}var u=q-this.bytesLoaded;this.bytesLoaded=q;var z=this.queueData.queueBytesUploaded+q;var a=Math.round(q/t*100);var b="KB/s";var r=0;var x=(u/1024)/(s/1000);x=Math.floor(x*10)/10;if(this.queueData.averageSpeed>0){this.queueData.averageSpeed=Math.floor((this.queueData.averageSpeed+x)/2)}else{this.queueData.averageSpeed=Math.floor(x)}if(x>1000){r=(x*0.001);this.queueData.averageSpeed=Math.floor(r);b="MB/s"}if(f.inArray("onUploadProgress",v.overrideEvents)<0){if(v.progressData=="percentage"){f("#"+w.id).find(".data").html(" - "+a+"%")}else{if(v.progressData=="speed"&&s>500){f("#"+w.id).find(".data").html(" - "+this.queueData.averageSpeed+b)}}f("#"+w.id).find(".uploadify-progress-bar").css("width",a+"%")
}if(v.onUploadProgress){v.onUploadProgress.call(this,w,q,t,z,this.queueData.uploadSize)}},onUploadStart:function(c){var b=this.settings;var a=new Date();this.timer=a.getTime();this.bytesLoaded=0;if(this.queueData.uploadQueue.length==0){this.queueData.uploadSize=c.size}if(b.checkExisting){f.ajax({type:"POST",async:false,url:b.checkExisting,data:{filename:c.name},success:function(i){if(i==1){var j=confirm('A file with the name "'+c.name+'" already exists on the server.\nWould you like to replace the existing file?');if(!j){this.cancelUpload(c.id);f("#"+c.id).remove();if(this.queueData.uploadQueue.length>0&&this.queueData.queueLength>0){if(this.queueData.uploadQueue[0]=="*"){this.startUpload()}else{this.startUpload(this.queueData.uploadQueue.shift())}}}}}})}if(b.onUploadStart){b.onUploadStart.call(this,c)
}},onUploadSuccess:function(c,a,j){var b=this.settings;var i=this.getStats();this.queueData.uploadsSuccessful=i.successful_uploads;this.queueData.queueBytesUploaded+=c.size;if(f.inArray("onUploadSuccess",b.overrideEvents)<0){f("#"+c.id).find(".data").html(" - Complete")}if(b.onUploadSuccess){b.onUploadSuccess.call(this,c,a,j)}}};f.fn.uploadify=function(a){if(d[a]){return d[a].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof a==="object"||!a){return d.init.apply(this,arguments)}else{f.error("The method "+a+" does not exist in $.uploadify")}}}})($);